= WebSocket Connector - Mule 4
ifndef::env-site,env-github[]
include::_attributes.adoc[]
endif::[]
:imagesdir: ../../assets/images/

Support Category: https://www.mulesoft.com/legal/versioning-back-support-policy#anypoint-connectors[Select]

WebSocket Connector Version 1.0

The Anypoint Connector for WebSocket (WebSocket Connector) enables you to take advantage of a key piece of current integration capabilities, including: 

* Establishing bi-directional and full-duplex communication between a server and client
* Implementing server push notifications
* Seamlessly working on top of existing HTTP infrastructure
* Avoiding the need for clients to regularly poll the server for new data

A WebSocket is a bi-directional, TCP connection between a client and server that is kept open until the application closes it. When using WeSockets, an application uses HTTP to make an initial connection. The connection then gets upgraded to a TCP socket-based connection.

== Advantages of Full-Duplex Communication

In traditional HTTP, a connection is half-duplex (unidirectional) and works by using a request-response message exchange pattern:

. A client connects to a server and sends a request.
. The server processes the request and sends a response back. The connection ends after the client receives the request.

Traditional HTTP connections require a lot of overhead because the client application is blocked until it receives a response from the server. Also, with this type of connection, the client must always initiate the request. Therefore, the server cannot push notifications to multiple applications at one time.

When a client connects to a server using WebSockets, a persistent connection is established and kept open. Both the client and server can then send multiple messages to each other without needing to follow the HTTP request-response message exchange pattern.

A WebsSocket is built on top of the existing HTTP infrastructure, making it easy to reuse infrastructure that is already in place for traditional HTTP.

For more information about WebSockets, see the https://tools.ietf.org/html/rfc6455[IETF document for RFC 6455 - The WebSocket protocol].

== Common Use Cases for the WebSocket Connector

The WebSocket Connector is useful for real-time applications that must avoid the overhead caused by the HTTP request-response message exchange pattern.

Typical use cases for WebSocket Connector include chat applications and stock quote applications.

=== Chat Applications

In a chat application, as soon as a client sends a message to a chat group, the other subscribed participants want to receive that message as soon as it becomes available. If an app uses HTTP, the clients must constantly poll the server for available messages, which can result in performance issues. If an app uses WebSockets, the server can push the available message to all subscribed users.

=== Stock Quotes Applications

Another example would be a service that provides stock quotes. Clients can open a WebSocket to such service, which will continuously send updated prices for a set of relevant stocks. Because such prices change continuously, the ability to reuse the same connection and receive messages at random times make WebSockets an ideal solution for this problem (notice that in this case, the client doesn't really send any messages to the server after the connection has been established).

== Compatibility

WebSocket Connector is compatible with:

|===
|Application/Service|Version
|Mule Runtime|4.2.2 or higher
|Java |1.8.0_x
|Anypoint Studio|7.4 or higher
|===

== Prerequisites

Before creating an app, you must have access to the WebSocket target resource and Anypoint Platform. You must also understand how to create a Mule app using
Design Center or Anypoint Studio.

== Basic WebSocket Connector Concepts

The following concepts are integral to understanding how WebSocket Connector works:

* <<socket_types,Socket types>>
* <<socket_id,Socket ID>>
* <<groups,Groups>>
* <<triggers,Triggers>>
* <<operations,Operations>>

[[socket_types]]
=== Socket Types

There are two types of WebSockets:

* Inbound +
WebSockets created when the Mule application listens for incoming connections.
+
In this scenario, an external system connects to an endpoint exposed by the Mule application.
+
* Outbound +
WebSockets created when the Mule application connects to an external system.
+
In this scenario, the Mule application initiates communication and asks an external system to establish a WebSocket.

[[socket_id]]
=== Socket ID

All WebSockets, both inbound and outbound, have a unique socket ID that identifies them. The app must reference these IDs to operate on individual WebSockets.

[[groups]]
=== Groups

WebSocket Connector introduces the concept of groups, which are string identifiers that individual WebSockets can optionally subscribe to. An app can use groups to broadcast one single message to a group of different WebSockets. Groups facilitate the process of identifying which WebSockets should participate in each broadcast.

Subscriptions only exist in the context of each instance of a Mule WebSocket Connector configuration. Therefore, when you establish a WebSocket between a Mule app and a remote system, subscribing the WebSocket on Mule's end of the connection to a group doesn't affect the WebSockets on the remote system's end.

[[triggers]]
== Triggers

Triggers initiate the execution of a flow upon receiving a message or event notification. You can specify the following triggers for WebSocket-related events:

* `inbound-listener` exposes an endpoint that external systems can connect to and initiates the containing flow when a message is received.
* `on-inbound-connection` initiates a flow when a new connection to the Inbound Listener is established.
* `outbound-listener` exposes an endpoint that initiates a flow when an outbound WebSocket receives a message from an external system.
* `on_connection-closed` initiates the containing flow when an inbound or outbound WebSocket is closed.

[[operations]]
== Operations

WebSocket Connector support the following operations:

* `open-outbound-socket` connects to an external system and creates an outbound webSocket.
* `send` sends a message through a WebSocket.
* `subscribe-groups` subscribes a WebSocket to one or more groups.
+
The app can invoke this operation on the same web socket multiple times. each invocation being additive over the previous ones. Repeated groups are ignored.
+
* `unsubscribe-groups` unsubscribes a WebSocket from one or more groups.
+
You can invoke this operation multiple times on the same socket, with each invocation being additive over the previous ones. Repeated groups are ignored.
+
* `broadcast` sends a message to multiple WebSockets classified by path, type, and group.
* `close-socket` closes a WebSocket's connection.

[[security]]
== Security

WebSockets Connector supports securing the client and server endpoints through TLS, using the following URI schemes:

* WS identifies a WebSocket server and resource name without using encryption (for example: `ws://localhost:80`).
* WSS identifies a WebSocket server and resource name, secure through TLS (for example: `wss://localhost:433`).


== See Also

*  xref:websocket/websocket-connector-key-concepts.adoc[WebSocket Connector Key Concepts]
*  xref:websocket/websocket-connector-configuration.adoc[WebSocket Connector Configuration]
* xref:websocket/websocket-connector-reference.adoc[WebSocket Connector Reference]
* https://help.mulesoft.com[MuleSoft Help Center]
